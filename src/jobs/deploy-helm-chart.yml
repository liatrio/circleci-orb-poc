executor: <<parameters.executor>>
parameters:
  app-name:
    type: string
  role-arn:
    default: AWS_ASSUME_ROLE
    type: string
  cluster-name:
    type: string
  executor:
    type: executor
    default: default
steps:
  - checkout
  - aws-cli/setup:
      configure-default-region: true
      configure-profile-region: true
  - aws-eks/install-aws-iam-authenticator
  - aws-assume-role
  - run: aws eks update-kubeconfig --name <<parameters.cluster-name>>
  - helm/upgrade-helm-chart:
      helm-version: v3.0.0
      release-name: <<parameters.app-name>>
      chart: ./<<parameters.app-name>>
